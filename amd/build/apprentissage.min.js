define(["jquery"],function(a){var b="",c=1,d=function(a){var b=a.split("#");return"#"+b[1]},e=function(b){var c=0,d="#cmapage"+b+" span[data-role='points']",e=new Array;a(d).each(function(){var b=a(this).html(),c=parseInt(b);e.push(c)});var f,g;for(g=0;g<4;++g)for(f=g+1;f<4;++f)if(e[f]==e[g]){c=1;break}return c},f=function(b){var c=0,d="#cmapage"+b+" span[data-role='points']";return a(d).each(function(){var b=a(this).html();""!=b&&c++}),c},g=function(b,c,d){var g="";""==c?c=4:c--,0==c&&(c=4);var h;h=a(b).attr("id").substr(6,2),a("#cmapoint"+h).html(c),a("input[name='word"+h+"']").attr("value",c),g=c-1,0==g&&(g=4),a("span[id*='affecter']").html(" "+g+" "),1==g&&a("span[id*='pluriel']").html(""),4==g&&a("span[id*='pluriel']").html("s");var i=f(d);if(4==i){var j=e(d);0==j?a("a[data-role='continue']").show():a("a[data-role='continue']").hide()}return c};return{init:function(){a(function(){a("div[data-role='page'], a[data-role='continue']").hide(),a("#cmapage1, #intro").show()}),a("div.mot").click(function(){b=g(this,b,c)}),a("a[data-role='continue']").click(function(){a("div[data-role='page']").hide(),a("a[data-role='continue']").hide();var e=d(this.href);a(e+", #intro").show(),c++,b="",a("span[id*='affecter']").html(" 4 "),a("span[id*='pluriel']").html("s")})}}});